# chaoxingsillyb
满分的故事

# 声明
本项目仅学习交流使用，切勿将其用于违法犯罪！请于下载后24小时内删除！本人不对该项目造成的任何后果负责


# 程序逻辑
- 自动截屏或用户手动复制所有题目，创建`questions.ini`，其内容为：  

        [题号]
        question = 问题内容
        type = 问题类型（单选题0，多选题1，填空题2，判断题3）
        
- 读取`question.ini`，并且根据`threadNum`创建对应数量线程搜索题目，以字典形式保存在全局变量`__questionList`中，在全部搜索完之后保存到`answers.ini`中，格式同上。并且，每道题如果搜索不到，还会尝试变化形式重新搜索（总共4次），搜索不到会打开百度；如果搜索到，则将此题从`questions.ini`中移除。
- 搜索完成后，使用`push(message)`方法推送给用户，使用`MessageSender`中的方法，有Bark、ServerChan、SMTP、控制台、文件等方法。其中，`message`为字典，格式为：`{'no': 题号, 'question': 题目题干, 'answer': 题目答案}`（可直接使用`__questionList`或`answers.ini`中的字典）
- 需要注意，在`__questionList`或`answers.ini`中，`\n`作为`\1`保存，使用时需替换。

# 关于题目获取的想法
## 以下方法全平台通用
- 在投屏窗口（预览模式）定时截屏，之后自动拼接，需要对比图片的局部相似度
- 在投屏窗口（单个题目）定时截屏，然后OCR对比文字相似度
- 实时截屏（单个题目）显示答案
- 滚动视频（截屏）（预览模式）生成长图并且进行OCR
- Fiddler抓取所有题目
## 以下方法仅对安卓适用
- 使用`Universal Copy`全局复制后进行文字分隔以获取题目
- 移动端脚本自动复制

# 备注
- 如果要加入忽略用户截图顺序的功能，首先要改变`__questionList`的排序方式，变为1,11,12这样的排序（把`int()`去掉即可)
- 其次在检测问题类型的时候，检测一下前面的大题题号（可选）。  
当时的代码如下：
  ```python
  if lastType != detectQuestionType(textProcess(tmp,0)):
    tp += nowNum
  ```

# 待办事项
- [X] 关键字优化（连接错误以及无答案时按照标点截短后文字重搜、第一次先保留括号如果四个均无答案则去掉括号重搜）
- [X] 显示优化（四个均无答案则自动弹出百度搜索结果、每次搜索前显示所搜索的关键字）
- [X] 引擎优化（增加api数、多个同时查询以缩短时间）
- [X] 数据库引入：没有查到的题录入待查数据库，稍后利用其它线程重新查询
- [X] 可以考虑先浏览一遍所有题，分别截图保存到不同文件中，再开双线程进行OCR和查题，最后按照题号输出，这样会快很多
- [ ] 加入一个类似搜索引擎的玩意，直接从教材里搜东西
- [ ] 自动切换OCR与剪切板复制功能，如果用户10秒没得输入，就自动保存题库，然后开始搜题，之后切换到手动模式。
- [X] 手动搜题模式实时显示答案，不需要进行文本处理
- [ ] 对半砍题干可以提高搜索成功率
